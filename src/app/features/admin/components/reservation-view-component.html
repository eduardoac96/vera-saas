<!-- VIEW DIALOG -->
<p-dialog header="Detalle de reserva" [(visible)]="viewDialog" [style]="{width: '560px'}" [modal]="true"
  [closable]="true">
  @if(reservation) {
  <div class="grid" style="grid-template-columns: 120px 1fr; gap: 12px; align-items: start;">
    <!-- Imagen -->
    <div>
      <img [src]="reservation.property?.photos?.[0]?.url || 'assets/img/placeholder-120x80.png'"
        alt="{{ reservation.property?.title || 'Propiedad' }}"
        style="width:120px;height:80px;object-fit:cover;border-radius:8px;border:1px solid #e6e6e6;" />
    </div>

    <!-- Detalles principales -->
    <div>
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <div>
          <h3 style="margin:0 0 6px 0;font-size:1.05rem;">{{ reservation.property?.title || '—' }}</h3>
          <div style="color:#6b6b6b;font-size:13px;">{{ reservation.property?.location?.city || '—' }}, {{
            reservation.property?.location?.country || '—' }}</div>
        </div>

        <!-- Tag status -->

      </div>

      <div style="margin-top:12px;font-size:14px;color:#333;">
        <div style="margin-bottom:6px;"><strong>Huésped:</strong> {{ reservation.guest?.fullName || '—' }}</div>
        <div style="margin-bottom:6px;"><strong>Check-In:</strong> {{ reservation.checkInDate ? (reservation.checkInDate
          | date:'dd/MM/yyyy') : '—' }}</div>
        <div style="margin-bottom:6px;"><strong>Check-Out:</strong> {{ reservation.checkOutDate ?
          (reservation.checkOutDate | date:'dd/MM/yyyy') : '—' }}</div>
        <div style="margin-bottom:6px;"><strong>Total:</strong> <span style="color:#0f9d58;font-weight:600;">{{
            reservation.totalPrice | currency:'USD':'symbol' }}</span></div>
        <div style="margin-top:8px;color:#666;font-size:13px;">Creada: {{ reservation.createdAt | date:'dd/MM/yyyy HH:mm' }} </div>
      </div>

      <div style="display:flex;gap:8px;margin-top:14px;">
        <button pButton type="button" icon="pi pi-pencil" label="Editar" class="p-button-sm p-button-warning"
          (click)="openEdit(reservation)"></button>
        <!-- <button pButton type="button" icon="pi pi-external-link" label="Ver Propiedad" class="p-button-sm p-button-text" (click)="goToProperty(reservation.property)"></button> -->
      </div>
    </div>
  </div>
  }
</p-dialog>

<!-- EDIT DIALOG -->
<p-dialog header="Editar reserva" [(visible)]="editDialog" [style]="{width: '680px', height: '500'}" [modal]="true" [closable]="true">
  <form [formGroup]="editForm" (ngSubmit)="saveEdit()" class="p-fluid responsive-grid"
    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px;">

    <!-- Columna izquierda -->
    <div style="display: flex; flex-direction: column; gap: 12px;">

      <div>
        <img [src]="reservation?.property?.photos?.[0]?.url || 'assets/img/placeholder-120x80.png'"
          alt="{{ reservation?.property?.title || 'Propiedad' }}"
          style="width:120px;height:80px;object-fit:cover;border-radius:8px;border:1px solid #e6e6e6;" />
      </div>


      <div>
        <h3 style="margin:0 0 6px 0;font-size:1.05rem;">{{ reservation?.property?.title || '—' }}</h3>
        <div style="color:#6b6b6b;font-size:13px;">{{ reservation?.property?.location?.city || '—' }}, {{
          reservation?.property?.location?.country || '—' }}</div>
      </div>
      <div style="margin-bottom:6px;"><strong>Huésped:</strong> {{ reservation?.guest?.fullName || '—' }}</div>


    </div>

    <!-- Columna derecha -->
    <div style="display: flex; flex-direction: column; gap: 12px;">
      <label>Check-In</label>
      <p-datepicker formControlName="checkInDate" showIcon dateFormat="dd/mm/yy" inputId="checkIn"></p-datepicker>

      <label>Check-Out</label>
      <p-datepicker formControlName="checkOutDate" showIcon dateFormat="dd/mm/yy" inputId="checkOut"></p-datepicker>

      <label>Total (USD)</label>
      <p-inputnumber formControlName="totalPrice" currency="USD" mode="currency" locale="en-US"></p-inputnumber>
    </div>
    <!-- Botones de acción -->
    <div style="grid-column: 1 / -1; display: flex; justify-content: flex-end; gap: 8px; margin-top: 12px;">
      <button pButton type="button" label="Cancelar" class="p-button-text" (click)="editDialog = false"></button>
      <button pButton type="submit" label="Guardar" [disabled]="editForm.invalid" class="p-button-success"></button>
    </div>
  </form>
 


</p-dialog>